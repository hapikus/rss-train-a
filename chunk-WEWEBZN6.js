import{a as ue,b as fe,c as _e,e as Ce,f as he}from"./chunk-3M7BBWJB.js";import{b as we}from"./chunk-NGRBF5RY.js";import{d as ee,e as ie,f as te,g as ne}from"./chunk-EWQNCL4D.js";import{$ as L,Ob as le,Pb as ae,Qb as me,Sb as se,Tb as pe,Vb as ce,Xb as de,Z as R,Zb as ge,_ as V,aa as j,ba as q,da as M,db as K,eb as Q,fa as G,fb as X,ga as A,gb as Y,hb as Z,ib as $,ja as U,k as W,la as H,na as J,tb as oe,ub as re}from"./chunk-AJSIW5UZ.js";import"./chunk-PQGTFRF3.js";import{Bb as P,Gb as w,Gc as S,Ia as s,Ib as C,Ja as p,Rb as g,Wb as m,Xb as r,Yb as z,Yc as B,Zb as D,_b as I,ac as b,f as N,fc as _,hc as d,ob as a,pb as v,pc as F,qc as u,sc as E,uc as y,vc as x,wa as k,wc as T,yc as O}from"./chunk-26O7SS3C.js";function ze(e,n){if(e&1){let i=b();m(0,"button",18),_("click",function(){s(i);let l=d();return p(l.enableNameField())}),z(1,"span",19),r()}}function be(e,n){if(e&1){let i=b();m(0,"button",18),_("click",function(){s(i);let l=d();return p(l.submitNewName())}),z(1,"span",20),r()}}function ve(e,n){if(e&1){let i=b();m(0,"button",18),_("click",function(){s(i);let l=d();return p(l.enableEmailField())}),z(1,"span",19),r()}}function Ne(e,n){if(e&1){let i=b();m(0,"button",18),_("click",function(){s(i);let l=d();return p(l.submitNewEmail())}),z(1,"span",20),r()}}function Pe(e,n){if(e&1&&(D(0),m(1,"nz-form-item")(2,"nz-form-control",21)(3,"nz-input-group",22),z(4,"input",23),r()()(),I()),e&2){d();let i=F(31);a(2),C("nzErrorTip",i)}}function ye(e,n){if(e&1){let i=b();m(0,"div")(1,"button",24),_("click",function(){s(i);let l=d();return p(l.updatePassword())}),u(2," Save "),r()()}if(e&2){let i=d();a(),C("disabled",i.profileForm.controls.password.invalid)}}function xe(e,n){e&1&&u(0," Incorrect email! ")}function Te(e,n){e&1&&u(0," Required! ")}function Ve(e,n){if(e&1&&u(0),e&2){let i=d(2);E(" ",i.errorMessage," ")}}function Me(e,n){if(e&1&&w(0,xe,1,0)(1,Te,1,0)(2,Ve,1,1),e&2){let i=n.$implicit,t=d();g(i.errors!=null&&i.errors.invalidEmail?0:-1),a(),g(i.errors!=null&&i.errors.required?1:-1),a(),g(t.profileForm.controls.userName.hasError("invalidEmail")?2:-1)}}function Fe(e,n){e&1&&u(0," Required! ")}function Ee(e,n){e&1&&u(0," Password has to be not less 8 symbols! ")}function Se(e,n){if(e&1&&u(0),e&2){let i=d(2);E(" ",i.errorMessage," ")}}function ke(e,n){if(e&1&&w(0,Fe,1,0)(1,Ee,1,0)(2,Se,1,1),e&2){let i=n.$implicit,t=d();g(i.errors!=null&&i.errors.required?0:-1),a(),g(i.errors!=null&&i.errors.minlength?1:-1),a(),g(t.profileForm.controls.password.hasError("userNotFound")?2:-1)}}var li=(()=>{let n=class n{constructor(t,l,o,c){this.router=t,this.formBuilder=l,this.loginService=o,this.apiService=c,this.errorMessage="",this.userName=P(""),this.email=P(""),this.role=P(""),this.profile=B(()=>({name:this.userName(),email:this.email(),role:this.role()})),this.isModalVisible=!1,this.nameFieldDisabled=!0,this.profileForm=new q({userName:new M({value:"",disabled:!0}),email:new M({value:"",disabled:!0},[Ce.emailValidation(),V.required]),password:new M("",[V.required,V.minLength(8)])}),this.imageUrl="assets/images/profile-train-1.jpg"}ngOnInit(){this.getProfile()}getProfile(){return N(this,null,function*(){let t=yield this.apiService.fetchProfile();this.userName.set(t.name),this.email.set(t.email),this.role.set(t.role)})}updateProfile(){return N(this,null,function*(){let t=yield this.apiService.updateProfile(this.profile());this.userName()!==t.name&&this.userName.set(t.name),this.email()!==t.email&&this.email.set(t.email),this.role()!==t.role&&this.role.set(t.role)})}updatePassword(){return N(this,null,function*(){this.profileForm.controls.password.valid&&this.apiService.updatePassword(this.profileForm.controls.password.value),this.hideModal()})}showModal(){this.isModalVisible=!0}hideModal(){this.isModalVisible=!1}enableNameField(){this.profileForm.get("userName")?.enable()}enableEmailField(){this.profileForm.get("email")?.enable()}submitNewName(){this.profileForm.controls.userName.valid&&(this.userName.set(this.profileForm.controls.userName.value||""),this.updateProfile(),this.profileForm.get("userName")?.disable())}submitNewEmail(){this.profileForm.controls.email.valid&&(this.email.set(this.profileForm.controls.email.value||""),this.updateProfile(),this.profileForm.get("email")?.disable())}};n.\u0275fac=function(l){return new(l||n)(v(W),v(H),v(he),v(ge))},n.\u0275cmp=k({type:n,selectors:[["app-profile"]],standalone:!0,features:[O],decls:32,vars:12,consts:[["emailErrorTpl",""],["passwordErrorTpl",""],["nz-form","",3,"formGroup"],["nz-button","",1,"button",3,"click","nzType"],[1,"margin-top-1"],[1,"field"],[1,"heading"],[1,"editable"],["type","text","formControlName","userName","nz-input","",3,"valueChange","keydown.enter","nzBorderless","value"],["nz-button","","nzType","text"],["nzErrorTip","Please input your email!","nzHasFeedback","",3,"nzErrorTip"],["type","text","nz-input","","formControlName","email",3,"valueChange","keydown.enter","nzBorderless","value"],["nz-button","","nzDanger","",1,"button",3,"click","nzType"],["nzWidth","300px","nzTitle","Change Password",3,"nzVisibleChange","nzOnCancel","nzVisible"],[4,"nzModalContent"],[4,"nzModalFooter"],[1,"image"],["nz-image","","nzDisablePreview","","alt","",3,"nzSrc"],["nz-button","","nzType","text",3,"click"],["nz-icon","","nzType","edit"],["nz-icon","","nzType","enter"],[3,"nzErrorTip"],["nzPrefixIcon","lock"],["type","password","nz-input","","formControlName","password","placeholder","Password"],["nz-button","","nzType","primary",1,"button",3,"click","disabled"]],template:function(l,o){if(l&1){let c=b();m(0,"form",2)(1,"button",3),_("click",function(){return s(c),p(o.showModal())}),u(2," Change Password "),r(),m(3,"nz-form-item",4)(4,"nz-form-control")(5,"div",5)(6,"p",6),u(7,"Name:"),r(),m(8,"div",7)(9,"input",8),T("valueChange",function(f){return s(c),x(o.userName,f)||(o.userName=f),p(f)}),_("keydown.enter",function(){return s(c),p(o.submitNewName())}),r(),w(10,ze,2,0,"button",9)(11,be,2,0,"button",9),r()()()(),m(12,"nz-form-item")(13,"nz-form-control",10)(14,"div",5)(15,"p",6),u(16,"Email:"),r(),m(17,"div",7)(18,"input",11),T("valueChange",function(f){return s(c),x(o.email,f)||(o.email=f),p(f)}),_("keydown.enter",function(){return s(c),p(o.submitNewEmail())}),r(),w(19,ve,2,0,"button",9)(20,Ne,2,0,"button",9),r()()()(),m(21,"button",12),_("click",function(){return s(c),p(o.loginService.logout())}),u(22," Log out "),r(),m(23,"nz-modal",13),T("nzVisibleChange",function(f){return s(c),x(o.isModalVisible,f)||(o.isModalVisible=f),p(f)}),_("nzOnCancel",function(){return s(c),p(o.hideModal())}),w(24,Pe,5,1,"ng-container",14)(25,ye,3,1,"div",15),r()(),m(26,"div",16),z(27,"img",17),r(),w(28,Me,3,3,"ng-template",null,0,S)(30,ke,3,3,"ng-template",null,1,S)}if(l&2){let c=F(29);C("formGroup",o.profileForm),a(),C("nzType","primary"),a(8),C("nzBorderless",o.profileForm.controls.userName.disabled),y("value",o.userName),a(),g(o.profileForm.controls.userName.disabled?10:11),a(3),C("nzErrorTip",c),a(5),C("nzBorderless",o.profileForm.controls.email.disabled),y("value",o.email),a(),g(o.profileForm.controls.email.disabled?19:20),a(2),C("nzType","primary"),a(2),y("nzVisible",o.isModalVisible),a(4),C("nzSrc",o.imageUrl)}},dependencies:[_e,se,re,oe,ae,le,me,de,pe,ce,fe,ue,$,Z,X,Y,we,ne,te,ie,ee,Q,K,J,G,R,L,j,A,U],styles:["[_nghost-%COMP%]{display:flex;width:fit-content;align-items:center;margin:0 auto;padding:.75rem;background-color:var(--form-background-color);border-radius:.5rem;column-gap:20px}.button[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{margin-left:.75rem;width:2rem}.value[_ngcontent-%COMP%]{width:100%;min-height:2rem}.editable[_ngcontent-%COMP%]{display:flex;gap:1rem}.margin-top-1[_ngcontent-%COMP%]{margin-top:1rem}.image[_ngcontent-%COMP%]{height:300px}.image[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{height:300px;object-fit:contain;border-radius:.25rem}@media (max-width: 575px){.image[_ngcontent-%COMP%]{display:none}}"]});let e=n;return e})();export{li as ProfileComponent};
